# Denoばた会議 Monthly 第14回
2022年10月30日開催。  
[connpassリンク](https://deno-ja.connpass.com/event/262130/)。

## 今月のアップデートを追う
Denoのアップデートを追っていくLT。  
そのあとの雑談込みでザックリと箇条書き。

[@uki00aさんのスライド](https://uki00a.github.io/slides/denobata-2022-10-30)

### Deno v1.27
#### npmパッケージで型チェックがサポート
- `deno check`などを実行した際に、対象のnpmパッケージに含まれる型定義ファイルの内容を元に、型チェックが実行される
- 型定義ファイルが同梱されていないパッケージについては、`@deno-types`で型定義を指定できる

#### Node-APIのサポート
- 現時点では、[Node-API](https://nodejs.org/docs/latest-v18.x/api/n-api.html)をベースに実装されたパッケージを利用するには、`--allow-ffi`の指定が必要

#### ロックファイル v2
- `--lock-write`によって出力されるロックファイルのフォーマットが変更された
- 次のDeno v1.28では、`deno.json`が存在する場合、ロックファイルをデフォルトで出力することが検討されているよう

#### `deno lsp`で[Inlay Hints](https://code.visualstudio.com/updates/v1_60#_inlay-hints-for-javascript-and-typescript)がサポート
- [vscode_deno](https://github.com/denoland/vscode_deno)を最新バージョンにアップデートし、`"editor.inlayHints.enabled"`に`"on"`などを設定すると有効化される

#### アップグレードチェッカー
- `deno`コマンド実行時にバージョンが古ければ更新案内が表示される
- もし不要であれば、`DENO_NO_UPDATE_CHECK`に`1`を設定すると無効化できる

#### `deno task`の改善
- 安定性に関する警告メッセージが表示されなくなった
- 複数のコマンドを並列で実行する際の挙動が変更されている

#### unstable APIの安定化
- 以下のAPIが安定化
  - `Deno.consoleSize`
  - `Deno.osRelease`
  - `Deno.stdin.setRaw`
  - `Deno.futime` / `Deno.futimeSync`
  - `Deno.loadavg`
  - `Deno.utime` / `Deno.utimeSync`

#### V8がv10.8へアップデート
- [Change Array by copy](https://github.com/tc39/proposal-change-array-by-copy)のサポートが入っている

#### `Deno.listen`と`Deno.listenTls`で`reusePort`オプションがサポート (Linuxのみ)

#### `Deno.listenDatagram`で`reuseAddress`オプションがサポート

#### `navigator.language`と`navigator.languages`が実装

#### `Deno.kill`と`Deno.Process.kill`の`signal`引数がオプショナルに変更 (デフォルトで`SIGTERM`を送信)

#### `Deno.listen`によってUnixドメインソケットを開く前にDenoの内部で行われていたソケットファイルの削除処理が廃止

### deno_stdのアップデート
- `std/hash`が削除 (今後は`std/crypto`で代用)
- `std/textproto`が削除 (今後は`TextLineStream`で代用)
- `CSVStream`や`JSONParseStream`などが削除 (今後は`CsvStream`や`JsonParseStream`などの形式のAPIで代用)

### Prisma v4.5.0
- Denoの初期サポートが入った
- [公式ガイド](https://www.prisma.io/docs/guides/deployment/deployment-guides/deploying-to-deno-deploy)も公開されている
- 現時点では、[Prisma Data Proxy](https://www.prisma.io/docs/data-platform/data-proxy)経由でのデータベース接続のみがサポート

### Nuxt 3でのDenoサポート
- [Nuxt 3](https://v3.nuxtjs.org/)のサーバエンジンである[Nitro](https://github.com/unjs/nitro)で[Deno presetの実装が進んでいる](https://github.com/unjs/nitro/pull/592)よう
- 実装されれば、Nuxt 3で開発されたアプリケーションをDeno Deploy上などで動かせるようになりそう

## 質問や共有コーナー

## 参考資料
上記をまとめる際に眺め、かつ箇条書きの中に含められなかった資料です。  
名前だけ掠ってて関係ない資料もあるかと思いますが、まとめる作業の可視化として残しています。  
読まなくて大丈夫です。

- [example](https://example.com/)
